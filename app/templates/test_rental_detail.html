<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Rental Detail Button</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h2>Test Rental Detail Button</h2>
        
        <div class="row">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>Test Request ID 48</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>Asset:</strong> Bangunan Surabaya Selatan 6</p>
                        <p><strong>Status:</strong> <span class="badge bg-success">Aktif</span></p>
                        
                        <button class="btn btn-sm btn-outline-primary" onclick="viewRentalDetails(48)">
                            <i class="fas fa-eye me-1"></i>Lihat Detail
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h5>Test Request ID 47</h5>
                    </div>
                    <div class="card-body">
                        <p><strong>Asset:</strong> Bangunan Surabaya Pusat 11</p>
                        <p><strong>Status:</strong> <span class="badge bg-warning">Menunggu</span></p>
                        
                        <button class="btn btn-sm btn-outline-primary" onclick="viewRentalDetails(47)">
                            <i class="fas fa-eye me-1"></i>Lihat Detail
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Console log area -->
        <div class="mt-4">
            <h4>Console Log:</h4>
            <div id="logArea" class="border p-3" style="height: 300px; overflow-y: auto; background: #f8f9fa;"></div>
        </div>
        
        <!-- Status area -->
        <div class="mt-3">
            <h5>Status:</h5>
            <div id="statusArea" class="alert alert-info">
                Ready to test. Click the "Lihat Detail" buttons above.
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Include the dashboard-user-history.js file -->
    <script src="/static/js/dashboard-user-history.js"></script>

    <script>
        // Override console.log to display in page
        const logArea = document.getElementById('logArea');
        const statusArea = document.getElementById('statusArea');
        const originalLog = console.log;
        const originalError = console.error;
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            logArea.innerHTML += '<div style="color: blue;">[LOG] ' + args.join(' ') + '</div>';
            logArea.scrollTop = logArea.scrollHeight;
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            logArea.innerHTML += '<div style="color: red;">[ERROR] ' + args.join(' ') + '</div>';
            logArea.scrollTop = logArea.scrollHeight;
        };

        // Initialize empty rentalRequests array (simulating empty local data)
        let rentalRequests = [];

        // Override alert to show in status area instead
        const originalAlert = window.alert;
        window.alert = function(message) {
            statusArea.innerHTML = `<strong>Alert:</strong> ${message}`;
            statusArea.className = 'alert alert-warning';
            originalAlert(message);
        };

        // Add success message function
        function showSuccess(message) {
            statusArea.innerHTML = `<strong>Success:</strong> ${message}`;
            statusArea.className = 'alert alert-success';
        }

        // Override the modal show function to update status
        const originalShowRentalDetailModal = window.showRentalDetailModal;
        if (typeof originalShowRentalDetailModal === 'function') {
            window.showRentalDetailModal = function(request) {
                showSuccess(`Modal would show for request ID ${request.id}: ${request.asset_name}`);
                return originalShowRentalDetailModal(request);
            };
        }

        // Log when page is ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Test page loaded');
            console.log('rentalRequests array:', rentalRequests);
            console.log('viewRentalDetails function available:', typeof window.viewRentalDetails);
        });
    </script>
</body>
</html>
